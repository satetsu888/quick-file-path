# Quick File Path - VSCode拡張機能

## 概要

ファイルの相対パスを素早くターミナルに入力するVSCode拡張機能

## 実現する機能

### 機能1: アクティブファイルのパスをターミナルに送信

- **トリガー**: エディタにフォーカスがある状態でユーザー設定のキーを押す
- **動作**: 現在編集中のファイルの相対パスをアクティブターミナルに送信
- **when条件**: `editorFocus`

### 機能2: エクスプローラ選択ファイルのパスをターミナルに送信

- **トリガー**: エクスプローラでファイルを選択した状態でユーザー設定のキーを押す
- **動作**: 選択中のファイルの相対パスをアクティブターミナルに送信
- **when条件**: `explorerViewletFocus && listFocus`

### 共通仕様

- パスはワークスペースルートからの相対パス
- パス区切り文字はPOSIX形式（`/`）を使用
- 改行は送信しない（入力のみ、実行はしない）
- デフォルトキーバインディングなし（利用者が `Cmd+K Cmd+S` で好みのキーを設定）

---

## 技術調査結果

### 使用するAPI

| 用途                     | API                                                  |
| ------------------------ | ---------------------------------------------------- |
| アクティブエディタ取得   | `vscode.window.activeTextEditor`                     |
| アクティブターミナル取得 | `vscode.window.activeTerminal`                       |
| 相対パス変換             | `vscode.workspace.asRelativePath(uri)`               |
| ターミナルに送信         | `terminal.sendText(text, false)` ※falseで改行なし   |
| エクスプローラ選択取得   | 組み込み `copyRelativeFilePath` + クリップボード経由 |
| クリップボード読み取り   | `vscode.env.clipboard.readText()`                    |

### キーバインディングのwhen条件

| 条件                   | 説明                               |
| ---------------------- | ---------------------------------- |
| `editorFocus`          | エディタにフォーカスがある         |
| `explorerViewletFocus` | エクスプローラビューにフォーカス   |
| `listFocus`            | リスト（ファイル一覧）にフォーカス |

### 制約事項

- エクスプローラからキーボードショートカットで呼び出した場合、選択ファイルのURIは自動では渡されない
- 代替策: `vscode.commands.executeCommand('copyRelativeFilePath')` を実行後、クリップボードから取得
- 副作用: クリップボードの内容が上書きされる

---

## 実装ステップ

### Phase 1: プロジェクトセットアップ

- [ ] `yo code` で拡張機能プロジェクトを生成
- [ ] TypeScript構成を選択
- [ ] 不要なボイラープレートを削除

### Phase 2: 機能1の実装（アクティブファイル → ターミナル）

- [ ] コマンド `quickFilePath.sendActiveFilePath` を登録
- [ ] アクティブエディタから相対パスを取得するロジック実装
- [ ] アクティブターミナルにテキストを送信するロジック実装

### Phase 3: 機能2の実装（エクスプローラ選択 → ターミナル）

- [ ] コマンド `quickFilePath.sendSelectedFilePath` を登録
- [ ] 組み込み `copyRelativeFilePath` を実行
- [ ] クリップボードからパスを取得
- [ ] アクティブターミナルにテキストを送信

### Phase 4: 仕上げ

- [ ] エラーハンドリング（ターミナルが開いていない場合など）
- [ ] パッケージ情報（package.json）の整備
- [ ] VSIXパッケージの生成

---

## ファイル構成（予定）

```text
quick-file-path/
├── package.json          # 拡張機能マニフェスト
├── src/
│   └── extension.ts      # メインロジック
├── tsconfig.json
└── README.md
```

---

## 決定事項

- **拡張機能名**: `quick-file-path`
- **キーバインディング**: デフォルトなし（利用者が任意に設定）
- **出力先**: ターミナル（エディタではない）
- **改行**: 送信しない（入力のみ）
